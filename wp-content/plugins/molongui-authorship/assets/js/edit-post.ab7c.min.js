function addAuthorToList(e,t,o){e.append('<li data-value="'+t+'">'+o+'<input type="hidden" name="molongui_authors[]" value="'+t+'" /><div class="m-tooltip"><span class="dashicons dashicons-trash js-remove"></span><span class="m-tooltip__text m-tooltip__left">'+molongui_authorship_edit_post_params.remove_author_tip+"</span></div></li>")}function RenderAuthorOption(e){return(molongui_authorship_edit_post_params.guest_enabled?["<div class='my-template'>",e.textContent,"<span class=''>",e.dataset.type,"</span>","</div>"]:["<div class='my-template'>",e.textContent,"</div>"]).join("")}function handleGuestQuickAdd(t,o){var n=jQuery("#molongui-add-guest-link"),l=jQuery("#molongui-add-guest-wrap"),e=jQuery("#molongui_new_guest_display_name"),a=jQuery("#molongui-add-btn"),r=jQuery("#molongui-cancel-btn");e.on("keypress",function(){jQuery(this).css("border-color","")}),n.on("click",function(){jQuery(this).parent().toggle(),l.toggle()}),r.on("click",function(){n.parent().toggle(),l.toggle()}),a.on("click",function(){if(0===e.val().trim().length)return e.css("border-color","red"),alert(molongui_authorship_edit_post_params.guest_name_error),!1;var a=jQuery(this),r=jQuery(this).html();jQuery(this).html('<div class="m-typing-loader"></div>'),jQuery.ajax({url:ajaxurl,type:"POST",data:{action:"quick_add_guest_author",display_name:e.val(),nonce:jQuery("#molongui_authorship_quick_add_nonce").val()},success:function(e){e=JSON.parse(e);e.error?(alert(molongui_authorship_edit_post_params.ajax_fn_error),a.html(r)):(o.add({value:e.guest_ref,text:e.guest_name}),t.length?addAuthorToList(t,e.guest_ref,e.guest_name):o.setValue(e.guest_ref),a.html(r),n.parent().toggle(),l.toggle())},error:function(e,t,o){alert(molongui_authorship_edit_post_params.ajax_call_error),a.html(r)}})})}jQuery.molonguiInitAuthorSelector=function(e,o,t){if(e){var a,r=o.length,n=new MolonguiSelectr(e,{defaultSelected:!1,allowDeselect:r,clearable:r,placeholder:t.trim()?t:molongui_authorship_edit_post_params.select_author_tip.trim()?molongui_authorship_edit_post_params.select_author_tip:r?"Select an(other) author...":"Select an author",renderOption:RenderAuthorOption,messages:{noOptions:"No authors available",noResults:"No authors found",searchPlaceholder:"Find author by name..."}});return jQuery(".selectr-input-container input.selectr-input").attr("placeholder","Find author by name..."),r&&(n.on("selectr.select",function(e){var t=n.getValue(!0);0===o.find("li[data-value="+t.value+"]").length&&addAuthorToList(o,t.value,t.text),n.clear();t=molongui_authorship_edit_post_params.select_author_tip.trim()?molongui_authorship_edit_post_params.select_author_tip:r?"Select an(other) author...":"Select an author";jQuery(".selectr-placeholder").html(t)}),void 0!==o&&(a=Sortable.create(o[0],{filter:".js-remove",onFilter:function(e){jQuery("#tiptip_holder").css("display","none");e=a.closest(e.item);e&&e.parentNode.removeChild(e)}}))),n}},jQuery(document).ready(function(e){var t=document.getElementById("_molongui_author"),o=e("ul#molongui_authors");handleGuestQuickAdd(o,e.molonguiInitAuthorSelector(t,o,""))});