"use strict";(function(a,b){"function"==typeof define&&define.amd?define(["./ResizeSensor.js"],b):"object"==typeof exports?module.exports=b(require("./ResizeSensor.js")):(a.ElementQueries=b(a.ResizeSensor),a.ElementQueries.listen())})("undefined"==typeof window?this:window,function(a){var b=function(){function b(a){a||(a=document.documentElement);var b=window.getComputedStyle(a,null).fontSize;return parseFloat(b)||16}function c(a){if(!a.getBoundingClientRect)return{width:a.offsetWidth,height:a.offsetHeight};var b=a.getBoundingClientRect();return{width:Math.round(b.width),height:Math.round(b.height)}}function d(a,c){var d=c.split(/\d/),e=d[d.length-1];switch(c=parseFloat(c),e){case"px":return c;case"em":return c*b(a);case"rem":return c*b();case"vw":return c*document.documentElement.clientWidth/100;case"vh":return c*document.documentElement.clientHeight/100;case"vmin":case"vmax":var f=document.documentElement.clientWidth/100,g=document.documentElement.clientHeight/100,h=Math["vmin"===e?"min":"max"];return c*h(f,g);default:return c;}}function e(a,b){this.element=a;var e,f,g,h,i,j,k,l,m=["min-width","min-height","max-width","max-height"];this.call=function(){for(e in g=c(this.element),j={},p[b])p[b].hasOwnProperty(e)&&(f=p[b][e],h=d(this.element,f.value),i="width"===f.property?g.width:g.height,l=f.mode+"-"+f.property,k="","min"===f.mode&&i>=h&&(k+=f.value),"max"===f.mode&&i<=h&&(k+=f.value),j[l]||(j[l]=""),k&&-1===(" "+j[l]+" ").indexOf(" "+k+" ")&&(j[l]+=" "+k));for(var a in m)m.hasOwnProperty(a)&&(j[m[a]]?this.element.setAttribute(m[a],j[m[a]].substr(1)):this.element.removeAttribute(m[a]))}}function f(b,c){b.elementQueriesSetupInformation||(b.elementQueriesSetupInformation=new e(b,c)),b.elementQueriesSensor||(b.elementQueriesSensor=new a(b,function(){b.elementQueriesSetupInformation.call()})),b.elementQueriesSetupInformation.call()}function g(a,b,c,d){if("undefined"==typeof p[a]){p[a]=[];var e=q.length;o.innerHTML+="\n"+a+" {animation: 0.1s element-queries;}",o.innerHTML+="\n"+a+" > .resize-sensor {min-width: "+e+"px;}",q.push(a)}p[a].push({mode:b,property:c,value:d})}function h(a){var b;if(document.querySelectorAll&&(b=a?a.querySelectorAll.bind(a):document.querySelectorAll.bind(document)),b||"undefined"==typeof $$||(b=$$),b||"undefined"==typeof jQuery||(b=jQuery),!b)throw"No document.querySelectorAll, jQuery or Mootools's $$ found.";return b}function i(a){var b=h(a);for(var c in p)if(p.hasOwnProperty(c))for(var d=b(c,a),e=0,g=d.length;e<g;e++)f(d[e],c)}function k(b){function c(){var a,c=!1;for(a in d)d.hasOwnProperty(a)&&e[a].minWidth&&b.offsetWidth>e[a].minWidth&&(c=a);if(c||(c=g),h===c)d[c].src=f[c];else if(!j[c]){var k=new Image;k.onload=function(){d[c].src=f[c],d[h].style.display="none",d[c].style.display="block",j[c]=!0,h=c},k.src=f[c]}else d[h].style.display="none",d[c].style.display="block",h=c}var d=[],e=[],f=[],g=0,h=-1,j=[];for(var k in b.children)if(b.children.hasOwnProperty(k)&&b.children[k].tagName&&"img"===b.children[k].tagName.toLowerCase()){d.push(b.children[k]);var i=b.children[k].getAttribute("min-width")||b.children[k].getAttribute("data-min-width"),l=b.children[k].getAttribute("data-src")||b.children[k].getAttribute("url");f.push(l);e.push({minWidth:i}),i?b.children[k].style.display="none":(g=d.length-1,b.children[k].style.display="block")}h=g,b.resizeSensorInstance=new a(b,c),c()}function l(){for(var a=h(),b=a("[data-responsive-image],[responsive-image]"),c=0,d=b.length;c<d;c++)k(b[c])}function m(a){var b,c,d,e;for(a=a.replace(/'/g,"\"");null!==(b=r.exec(a));)for(c=b[1]+b[3],d=b[2];null!==(e=s.exec(d));)g(c,e[1],e[2],e[3])}function n(a){var b="";if(a)if("string"==typeof a)a=a.toLowerCase(),(-1!==a.indexOf("min-width")||-1!==a.indexOf("max-width"))&&m(a);else for(var c=0,d=a.length;c<d;c++)1===a[c].type?(b=a[c].selectorText||a[c].cssText,-1!==b.indexOf("min-height")||-1!==b.indexOf("max-height")?m(b):(-1!==b.indexOf("min-width")||-1!==b.indexOf("max-width"))&&m(b)):4===a[c].type?n(a[c].cssRules||a[c].rules):3===a[c].type&&a[c].styleSheet.hasOwnProperty("cssRules")&&n(a[c].styleSheet.cssRules)}var o,p={},q=[],r=/,?[\s\t]*([^,\n]*?)((?:\[[\s\t]*?(?:min|max)-(?:width|height)[\s\t]*?[~$\^]?=[\s\t]*?"[^"]*?"[\s\t]*?])+)([^,\n\s\{]*)/mgi,s=/\[[\s\t]*?(min|max)-(width|height)[\s\t]*?[~$\^]?=[\s\t]*?"([^"]*?)"[\s\t]*?]/mgi,t=!1;this.init=function(){var b="animationstart";"undefined"==typeof document.documentElement.style.webkitAnimationName?"undefined"==typeof document.documentElement.style.MozAnimationName?"undefined"!=typeof document.documentElement.style.OAnimationName&&(b="oanimationstart"):b="mozanimationstart":b="webkitAnimationStart",document.body.addEventListener(b,function(b){var c=b.target,d=c&&window.getComputedStyle(c,null),e=d&&d.getPropertyValue("animation-name"),g=e&&-1!==e.indexOf("element-queries");if(g){c.elementQueriesSensor=new a(c,function(){c.elementQueriesSetupInformation&&c.elementQueriesSetupInformation.call()});var h=window.getComputedStyle(c.resizeSensor,null),i=h.getPropertyValue("min-width");i=parseInt(i.replace("px","")),f(b.target,q[i])}}),t||(o=document.createElement("style"),o.type="text/css",o.innerHTML="[responsive-image] > img, [data-responsive-image] {overflow: hidden; padding: 0; } [responsive-image] > img, [data-responsive-image] > img {width: 100%;}",o.innerHTML+="\n@keyframes element-queries { 0% { visibility: inherit; } }",document.getElementsByTagName("head")[0].appendChild(o),t=!0);for(var c=0,d=document.styleSheets.length;c<d;c++)try{document.styleSheets[c].href&&0===document.styleSheets[c].href.indexOf("file://")&&console.log("CssElementQueries: unable to parse local css files, "+document.styleSheets[c].href),n(document.styleSheets[c].cssRules||document.styleSheets[c].rules||document.styleSheets[c].cssText)}catch(a){}l()},this.findElementQueriesElements=function(a){i(a)},this.update=function(){this.init()}};b.update=function(){b.instance.update()},b.detach=function(a){a.elementQueriesSetupInformation?(a.elementQueriesSensor.detach(),delete a.elementQueriesSetupInformation,delete a.elementQueriesSensor):a.resizeSensorInstance&&(a.resizeSensorInstance.detach(),delete a.resizeSensorInstance)},b.init=function(){b.instance||(b.instance=new b),b.instance.init()};var c=function(a){if(document.addEventListener)document.addEventListener("DOMContentLoaded",a,!1);else if(/KHTML|WebKit|iCab/i.test(navigator.userAgent))var b=setInterval(function(){/loaded|complete/i.test(document.readyState)&&(a(),clearInterval(b))},10);else window.onload=a};return b.findElementQueriesElements=function(a){b.instance.findElementQueriesElements(a)},b.listen=function(){c(b.init)},b});